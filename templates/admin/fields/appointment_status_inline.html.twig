{# Inline status editor for Appointment index page (dropdown menu) #}
{% set _id = entity.primaryKeyValue %}
{% set _status = field.value %}

{% set badgeClass = {
  'PENDING': 'badge badge-warning',
  'CONFIRMED': 'badge badge-success',
  'COMPLETED': 'badge badge-info',
  'CANCELED': 'badge badge-danger'
}[_status]|default('badge badge-secondary') %}

{% set url = ea_url()
  .setController('App\\Controller\\Admin\\AppointmentCrudController')
  .setAction('ajaxSetStatus')
  .setEntityId(_id)
%}

<span class="js-appointment-status-wrap dropdown d-inline-flex align-items-center" data-id="{{ _id }}">
  <button type="button"
          class="js-appointment-status-badge {{ badgeClass }} dropdown-toggle border-0"
          data-current="{{ _status }}"
          data-url="{{ url }}"
          data-token="{{ csrf_token('appointment_status') }}"
          data-bs-toggle="dropdown"
          aria-expanded="false">
    {{ _status }}
  </button>

  <ul class="dropdown-menu dropdown-menu-dark shadow js-appointment-status-menu">
    <li>
      <button class="dropdown-item d-flex align-items-center gap-2 js-appointment-status-item" type="button" data-status="PENDING">
        <span class="badge badge-warning">PENDING</span>
        <span class="ms-auto opacity-75 js-appointment-status-check" data-status="PENDING"></span>
      </button>
    </li>
    <li>
      <button class="dropdown-item d-flex align-items-center gap-2 js-appointment-status-item" type="button" data-status="CONFIRMED">
        <span class="badge badge-success">CONFIRMED</span>
        <span class="ms-auto opacity-75 js-appointment-status-check" data-status="CONFIRMED"></span>
      </button>
    </li>
    <li>
      <button class="dropdown-item d-flex align-items-center gap-2 js-appointment-status-item" type="button" data-status="COMPLETED">
        <span class="badge badge-info">COMPLETED</span>
        <span class="ms-auto opacity-75 js-appointment-status-check" data-status="COMPLETED"></span>
      </button>
    </li>
    <li>
      <button class="dropdown-item d-flex align-items-center gap-2 js-appointment-status-item" type="button" data-status="CANCELED">
        <span class="badge badge-danger">CANCELED</span>
        <span class="ms-auto opacity-75 js-appointment-status-check" data-status="CANCELED"></span>
      </button>
    </li>
  </ul>
</span>

